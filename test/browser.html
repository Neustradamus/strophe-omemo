<!DOCTYPE html>
<html>
  <head> 
    <meta charset="UTF-8">  
    <script type="text/javascript" src="../js/libs/strophejs/strophe.js"></script>
    <script type="text/javascript" src="../js/store.js"></script>
    <script type="text/javascript" src="../js/libs/libsignaljs/dist/libsignal-protocol.js"></script> 
    <script type="text/javascript" src="../js/jquery-3.2.1.min.js"></script> 
    <script type="text/javascript" src="../dist/co-strophe.omemo.js"></script> 
    <!-- <script type="text/javascript" src="../js/template.js"></script>  -->
    <script type="text/javascript" src="../dist/co-codec.js"></script>  
    <script type="text/javascript" src="../dist/co-gcm.js"></script>  
    <script type="text/javascript" src="../dist/co-bundle.js"></script>  

    <style> 
.pass:before { 
  content: 'PASS: '; 
  color:  blue; 
  font-weight: bold; 
} 

    .fail:before { 
      content: 'FAIL: '; 
      color: red; 
      font-weight: bold; 

    } 
    </style> 
  </head>
  <body>

    <ul id="output"></ul> 
    <script> 
var output = document.getElementById('output'); 

function assert( outcome, description ) { 
  var li = document.createElement('li'); 
  li.className = outcome ? 'pass' : 'fail'; 
  li.appendChild( document.createTextNode( description ) ); 

  output.appendChild(li); 
}; 
    </script>
  </body>
  <script> 
//tests start here.
function add(num1, num2) { 
  return num1 + num2; 
} 

var result = add(2, 2); 

assert( result == 4, 'Checking the add function'); 
assert( result == 8, 'Checking the add function'); 

var store =  new SignalProtocolStore();
var KeyHelper = libsignal.KeyHelper;
var registrationId = KeyHelper.generateRegistrationId();
console.log("libsig regId: " + registrationId)
// Store registrationId somewhere durable and safe.

KeyHelper.generateIdentityKeyPair().then(function(identityKeyPair) {
  // keyPair -> { pubKey: ArrayBuffer, privKey: ArrayBuffer }
  // Store identityKeyPair somewhere durable and safe.
});

//var key = gcm.key() does not get defined. still an issue with returning the value from the promise.
var iv = gcm.iv()
var aad = gcm.aad()
var msg = "hello"
//gcm.encrypt(msg, iv, key, aad) wont trigger on its own due tot he issue with gcm.key()
//KeyHelper.generatePreKey(keyId).then(function(preKey) {
//  store.storePreKey(preKey.keyId, preKey.keyPair);
//});
//
//KeyHelper.generateSignedPreKey(identityKeyPair, keyId).then(function(signedPreKey) {
//  store.storeSignedPreKey(signedPreKey.keyId, signedPreKey.keyPair);
//});
  </script>
</html>

